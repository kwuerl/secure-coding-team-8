\subsection{Testing for Clickjacking - OTG-CLIENT-009}
\subsubsection{BANK-APP}
\begin{longtable}[l]{ p{2.3cm} | p{.79\linewidth} }\hline
    & \textbf{BANK-APP}
    \hfill CVSS Score: 5.3 \progressbar[filledcolor=BurntOrange]{0.53}
    \\ \hline
    \textbf{Observation} & Creating an HTML iframe with the bank application as source shows the website. Furthermore, the HTTP header option \code{X-Frame-Options} is not set. \\
    \textbf{Discovery} & Creating a simple HTML site with an iframe with the bank application URL as \code{src} showed the website in the iframe. Looking at the HTTP header with ZAP it can be seen that the option \code{X-Frame-Options} is not set. \\
    \textbf{Likelihood} & Testing whether a URL can be loaded within an iframe is not difficult. An attacker can easily create a malicious website with a hidden iframe. \\
    \textbf{Impact} & Because the bank application can be loaded into an iframe, an attacker could make a user transfer money to the attacker without the user noticing it. The attacker could also make the user type in his password without knowing that he/she is logging into his/her bank account. \\
    \textbf{Recommen\-dations} & Set the \code{X-Frame-Options} header to either \code{DENY} or \code{SAMEORIGIN}. \\ \hline
    \textbf{CVSS} &
        \begin{tabular}[t]{@{}l | l}
            Attack Vector           & \textcolor{red}{Network} \\
            Attack Complexity       & \textcolor{Green}{High} \\
            Privileges Required     & \textcolor{red}{None} \\
            User Interaction        & \textcolor{Green}{Required} \\
            Scope                   & \textcolor{Green}{Unchanged} \\
            Confidentiality Impact  & \textcolor{red}{High} \\
            Integrity Impact        & \textcolor{Green}{None} \\
            Availability Impact     & \textcolor{Green}{None}
        \end{tabular}
    \\ \hline
\end{longtable}

\subsubsection{SecureBank}
\begin{longtable}[l]{ p{2.3cm} | p{.75\linewidth} }\hline
    & \textbf{SecureBank}
    \hfill CVSS Score: 5.3 \progressbar[filledcolor=BurntOrange]{0.53}
    \\ \hline
    \textbf{Observation} & Creating an HTML iframe with the bank application as source shows the website. Furthermore, the HTTP header option \code{X-Frame-Options} is not set. \\
    \textbf{Discovery} & Creating a simple HTML site with an iframe with the bank application URL as \code{src} showed the website in the iframe. Looking at the HTTP header with ZAP it can be seen that the option \code{X-Frame-Options} is not set. \\
    \textbf{Likelihood} & Testing whether a URL can be loaded within an iframe is not difficult. An attacker can easily create a malicious website with a hidden iframe. \\
    \textbf{Impact} & Because the bank application can be loaded into an iframe, an attacker could make a user transfer money to the attacker without the user noticing it. The attacker could also make the user type in his password without knowing that he/she is logging into his/her bank account. \\
    \textbf{Recommen\-dations} & Set the \code{X-Frame-Options} header to either \code{DENY} or \code{SAMEORIGIN}. \\ \hline
    \textbf{CVSS} &
        \begin{tabular}[t]{@{}l | l}
            Attack Vector           & \textcolor{red}{Network} \\
            Attack Complexity       & \textcolor{Green}{High} \\
            Privileges Required     & \textcolor{red}{None} \\
            User Interaction        & \textcolor{Green}{Required} \\
            Scope                   & \textcolor{Green}{Unchanged} \\
            Confidentiality Impact  & \textcolor{red}{High} \\
            Integrity Impact        & \textcolor{Green}{None} \\
            Availability Impact     & \textcolor{Green}{None}
        \end{tabular}
    \\ \hline
\end{longtable}

\subsubsection{Comparison}
Both bank applications can be loaded into an iframe, which makes the application vulnerable to clickjacking. Listing~\ref{lst:iframe} shows the simple HTML code to test whether a website can be loaded into an iframe.

\begin{lstlisting}[caption={HTML code for testing a website whether it can be loaded in an iframe}\label{lst:iframe}, language=HTML, basicstyle=\footnotesize, frame=single, captionpos=t, linewidth=.9\textwidth, xleftmargin=.12\textwidth]
<!DOCTYPE HTML>
<html>
  <head>
    <title>Test Clickjacking</title>
  </head>
  <body>
    <iframe src="http://IP_ADDRESS/" width="1000px" height="500px">
  </body>
</html>
\end{lstlisting}
\clearpage