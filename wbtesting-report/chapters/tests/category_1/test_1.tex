\subsection{Test File Extensions Handling for Sensitive Information - OTG-CONFIG-003} \label{OTG-CONFIG-003}

\begin{longtable}[l]{ p{2.3cm} | p{.79\linewidth} }\hline
    & \textbf{InternetBanking} \\ \hline
    \textbf{Observation} & It was found that the application allowed only text files. No other files were accepted. \\
    \textbf{Discovery} & By manually inspecting the code, appropriate checks for text files were found. The code from \code{clientFunctions.php} is below:
        \begin{lstlisting}
                if ($_FILES["tranfile"]["size"] > 500)
                {
                    $uploadOk = 0;
                    throw new Exception("File too large!");

                }

                if($file_type != "txt")
                {
                    $uploadOk = 0;
                    throw new Exception("Only txt files are accepted!");
                }
        \end{lstlisting}
    \\
    \textbf{Likelihood} & Likelihood is high as there are no technical skills required for the attacker. A Brute force approach could yield results in a short time.\\
    \textbf{Impact} & The messages shown by the application are inconsistent with the view. It is unclear as to what actions took place in the background, making the application clearly vulnerable. Transactions are not reflected under \enquote{View Transactions} page. Hence the user gets a wrong impression of his transactions. These messages are returned from server, so chances of these files actually getting uploaded are high. So an attacker could upload any malicious script files(\enquote{.php}) to manipulate the server and retrieve/corrupt sensitive data. \\
    \textbf{Recommen\-dations} & Based on the requirements of the application, irrelevant file types should be restricted, both from client-side and server-side. Additionally, messages should always be consistent and reflect the right behavior.\\ \hline
    \textbf{CVSS} & N/A
    \\ \hline
\end{longtable}
\clearpage

\begin{longtable}[l]{ p{2.3cm} | p{.79\linewidth} }\hline
    & \textbf{SecureBank} \\ \hline
    \textbf{Observation} & It was found that the application allowed only text files. No other files were accepted. \\
    \textbf{Discovery} & By manually inspecting the code, appropriate checks for text files were found. The code from \code{TransactionController.php} is below:
        \begin{lstlisting}
                if ($file['type'] != "text/plain") {
                    $this->get("flash_bag")->add(_OPERATION_FAILURE,
                    "The uploaded file must be a plain text file",
                    "error");
                    $this->get("routing")->redirect("make_transfer_get",
                    array("form" => $helper, "form2" => $helper2));
                    return;
                } else if ($file['error'] == 2) {
                    $this->get("flash_bag")->add(_OPERATION_FAILURE,
                    "The uploaded file size exceeds the maximum of 1 MB",
                    "error");
                    $this->get("routing")->redirect("make_transfer_get",
                    array("form" => $helper, "form2" => $helper2));
                    return;
                }
        \end{lstlisting}
    \\
    \textbf{Likelihood} & N/A \\
    \textbf{Impact} & N/A \\
    \textbf{Recommen\-dations} & N/A \\ \hline
    \textbf{CVSS} & N/A
    \\ \hline
\end{longtable}

\subsubsection{Comparison}
Both applications handle file extensions properly and neither of them poses any vulnerability.
\clearpage