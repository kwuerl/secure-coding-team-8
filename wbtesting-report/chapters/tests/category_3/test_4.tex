\subsection{Testing for bypassing authentication schema - OTG-AUTHN-004}
\subsubsection{Online Banking}
\begin{longtable}{p{2.3cm} | p{.79\linewidth}}
    \hline
    & \textbf{Online Banking} \\ 
    \hline
    \textbf{Observation} &
        There were several observations:
        \begin{itemize}
          \item Session ID Prediction is not possible
          \item Parameter modification is not possible
          \item SQL Injection is not possible in the Login form
          \item Direct Page access is not possible
        \end{itemize}
    \\
    \textbf{Discovery} &
        As Online Banking uses the standard PHP 5.3 way of generating Session IDs it is not vulnerable to Session ID Prediction. See \ref{code:auth_server_ib}.\newline
        Parameter modification was eliminated by manually looking at the url parameters in the app. \newline
        For SQL Injection please refer to OTG-INPVAL-005. \newline
        Direct page access is not possible as the app uses checks to determine if the applications is bootstrapped and the user is logged in. See \ref{code:auth_check_ib} \newline
    \\
    \textbf{Likelihood} &
       N/A
    \\
    \textbf{Impact} &
        N/A
    \\
    \textbf{Recommen\-dations} & 
        N/A
    \\ \hline
    \textbf{CVSS} &
        N/A
    \\
    \hline
\end{longtable}
\clearpage

\subsubsection{SecureBank}
\begin{longtable}{p{2.3cm} | p{.79\linewidth}}
    \hline
    & \textbf{SecureBank} \\ 
    \hline
    \textbf{Observation} &
        There were several observations:
        \begin{itemize}
		  \item Direct Page access is not possible
		  \item Parameter modification is not possible
		  \item Session ID Prediction is not possible
		  \item SQL Injection is not possible in the Login form
		\end{itemize}
    \\
    \textbf{Discovery} &
    	As SecureBank uses the standard PHP 5.3 way of generating Session IDs it is not vulnerable to Session ID Prediction. \newline
        Parameter modification was eliminated by manually looking at the url parameters in the app. \newline
        For SQL Injection please refer to OTG-INPVAL-005 \newline
        Direct page access has no effect as the Application uses Object a router that blocks direct access.  \newline
    \\
    \textbf{Likelihood} &
       N/A
    \\
    \textbf{Impact} &
        N/A
    \\
    \textbf{Recommen\-dations} & 
        N/A
    \\ \hline
    \textbf{CVSS} &
        N/A
    \\
    \hline
\end{longtable}

\subsubsection{Comparison}
Online Banking contains a very weak authentification mechanism as direct page access is possible for almost every page.
SecureBank does not seem to have this security flaws.
\clearpage

\begin{lstlisting}[caption={PHP code for sessions from auth.php}\label{code:auth_server_ib}, language=PHP, basicstyle=\footnotesize, frame=single, captionpos=t, linewidth=.9\textwidth, xleftmargin=.12\textwidth]
session_start();
$currentCookieParams = session_get_cookie_params(); 
session_set_cookie_params( 
    $currentCookieParams["lifetime"], 
    $currentCookieParams["path"], 
    $currentCookieParams["domain"], 
    true, 
    true 
); 
\end{lstlisting}
\begin{lstlisting}[caption={PHP code for auth-check in clientController.php}\label{code:auth_check_ib}, language=PHP, basicstyle=\footnotesize, frame=single, captionpos=t, linewidth=.9\textwidth, xleftmargin=.12\textwidth]
if (!defined('MyConst')){
    die('not permitted');
}
if ($sessionisemployee){
    die('Not client.');
}
\end{lstlisting}