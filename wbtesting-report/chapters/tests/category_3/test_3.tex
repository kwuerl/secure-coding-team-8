\subsection{Testing for Weak lock out mechanism - OTG-AUTHN-003}

\begin{longtable}[l]{ p{2.3cm} | p{.79\linewidth} }\hline
    & \textbf{Online Banking}
    \hfill CVSS Score: 7.5 \progressbar[filledcolor=red]{0.75}
    \\ \hline
    \textbf{Observation} & Logging in with a false password can be repeated numerous times without being locked out. \\
    \textbf{Discovery} & The file \code{DataAccess.php} has the function \code{Authenticate}, which checks whether there is a user with the username and the hashed password. If that user exists, the function returns the user, otherwise it returns \code{null}. There is no code for counting the number of times a user has tried to login, therefore no lock out mechanisms are implemented. \\
    \textbf{Likelihood} & Since there is no lock out mechanism an attacker could bruteforce the password. \\
    \textbf{Impact} & If an attacker gains access to an account, he could also gain access to private information. Furthermore, if he can find out the transaction codes, he could also make transactions. Since there is no possibility of changing account data or deleting the account, there is no impact on integrity and availability. \\
    \textbf{Recommen\-dations} & Set a maximum number of times a user can try to login with a wrong password. After that the account should be locked either temporarily or has to be unlocked by an employee. \\ \hline
    \textbf{CVSS} &
        \begin{tabular}[t]{@{}l | l}
            Attack Vector           & \textcolor{red}{Network} \\
            Attack Complexity       & \textcolor{red}{Low} \\
            Privileges Required     & \textcolor{red}{None} \\
            User Interaction        & \textcolor{red}{None} \\
            Scope                   & \textcolor{Green}{Unchanged} \\
            Confidentiality Impact  & \textcolor{red}{High} \\
            Integrity Impact        & \textcolor{Green}{None} \\
            Availability Impact     & \textcolor{Green}{None}
        \end{tabular}
    \\ \hline
\end{longtable}

\begin{longtable}[l]{ p{2.3cm} | p{.79\linewidth} }\hline
    & \textbf{SecureBank} \\ \hline
    \textbf{Observation} & Logging in with a false password can be repeated 5 times before the account is locked. \\
    \textbf{Discovery} & In \code{Auth/DBAuthProvider.php} the account is checked for the number of login attempts. If that number is bigger or equal to 4, the login attempt number is set to 5 and the account is locked for 60 minutes. \\
    \textbf{Likelihood} & N/A \\
    \textbf{Impact} & N/A \\
    \textbf{Recommen\-dations} & N/A \\ \hline
    \textbf{CVSS} & N/A \\ \hline
\end{longtable}

\subsubsection{Comparison}
Online Banking does not have any lock out mechanisms, whereas SecureBank locks the account after several unsuccessful login attempts.
\clearpage