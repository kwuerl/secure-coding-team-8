\subsection{Test Upload of Malicious Files - OTG-BUSLOGIC-009}
\paragraph{BANK-APP} \mbox{}
\begin{longtable*}{p{.30\textwidth} | p{.70\textwidth}}
    \hline
    & \textbf{BANK-APP} \\
    \hline
    \textbf{Observation} &
      Though the application restricts the user from uploading files other than text, but it has no restriction on filenames which can be exploited for shell command injections.
    \\\\
    \textbf{Discovery} &
        No tools were used to discover this vulnerability. We manually changed the filename to inject shell commands.
        \begin{itemize}
        \item Steps:
                1. Name a file as "test;touch myfile.txt;.txt".
                2. Login as a customer and go to the "New Transaction" interface. When above file is uploaded, transaction fails.
                However, shell command injection is successful which can be observed by verifying the creation of a file with the same name under
                \code{http://xxx.xxx.xxx.xxx/secure-coding/app/}. 
                Our command "touch myfile.txt" has created an empty text file called "myfile.txt".
        \end{itemize}        
    \\\\
    \textbf{Likelihood} &
        Filenames can be easily manipulated without the use of any tools which makes this vulnerability easy to be exploited.
    \\\\
    \textbf{Impact} &
       With this attack, any command can be executed which may be harmful for the system hosting the application. Directories can be deleted which may lead to Denial Of Service attack.
    \\\\
    \textbf{CVSS} &
      \begin{tabular}{| l | l |}
      \hline
      Attack Vector		& \textcolor{red}{Network}\\
      \hline
      Attack Complexity	& \textcolor{red}{Low} \\
      \hline
      Privileges Required & \textcolor{red}{None} \\
      \hline
      User Interaction	& \textcolor{red}{None} \\
      \hline
      Scope		& \textcolor{red}{Changed} \\
      \hline
      Confidentiality	& \textcolor{Green}{Low} \\
      \hline
      Integrity		& \textcolor{Green}{Low} \\
      \hline
      Availability		& \textcolor{red}{High} \\
      \hline
      \end{tabular}
    \\\\
    \textbf{Recommendations} &
    	Filenames should be validated before the execution of shell commands to avoid such attacks. In this case, we could remove unwanted characters from the file name (such as ; or ||). This would prevent command piping which creates a leverage for such attacks.\\
    	\hline
\end{longtable*}
\paragraph{SecureBank} \mbox{}
\begin{longtable*}{p{.30\textwidth} | p{.70\textwidth}}
    \hline
    & \textbf{SecureBank} \\
    \hline
    \textbf{Observation} &
      In the application we observed that upload of malicious files is not possible since file names are sanitized. Also, upload is restricted to files of plain text only.
    \\\\
    \textbf{Discovery} &
     Same steps as described above were followed but shell injection was not successful and the file "myfile.txt" was not created.
    \\\\
    \textbf{Likelihood} &
        N/A
    \\\\
    \textbf{Impact} &
        N/A
    \\\\
    \textbf{CVSS} &
        N/A
    \\\\
    \textbf{Recommendations} &
     N/A\\
     \hline	
\end{longtable*}
\clearpage