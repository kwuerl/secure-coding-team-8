\subsection{Testing for Insecure Direct Object References - OTG-AUTHZ-004}

\subsubsection{Observation 1}
The value of a parameter is used directly to retrieve a database record and this vulnerability has been observed in the Transactions page.
A customer can gain unauthorized access to transactions of all other customers. This data is intended for access only by authorized employees, but it has been exposed to all logged-in users. 

\subsubsection{Discovery}
No specific tool was required to discover this vulnerability, it was encountered by manually altering the URL.\\
Steps: \\
1. Login as a Customer. \\
2. Click on “Open” corresponding to any of the completed transactions. \\
3. The details of the specific transaction are shown. \\
4. The URL in the address bar is of the form \\ \textit{"<IP-address>/secure-coding/public/view\_transaction.php?id=17"}. \\
5. Edit the id at the end to any other number. \\
If a transaction with that id exists, then the complete details are displayed, thus revealing the Account IDs of the sender \& recipient, TAN numbers etc. \\

\subsubsection{Likelihood}
Likelihood is high.
The attacker need not have any specialized skills to exploit this vulnerability. Any customer who is logged in to the bank can perform this action. Also, guessing the transaction id to enter at the end of the URL is not difficult either, as they are sequential and a Brute-force method is quite easy.

\subsubsection{Impact}
A customer can get hold of details pertaining to other customers such as Account numbers, TAN numbers etc. Using the Account numbers, he/she can make infinite transactions with negative amounts, thus transferring money from the victim's account to his/her own.
Also, it may be possible to make guesses about the TAN generation by observing the nature of numerous TANs being generated.

\subsubsection{CVSS}
\begin{tabular}{l | l}
Attack Vector		& Network \\
Attack Complexity	& Low \\
Privileges Required & Low \\
User Interaction	& None \\
Scope				& Changed \\
Confidentiality		& High \\
Integrity			& None \\
Availability		& None
\end{tabular}

\subsubsection{Comparison with our application}
In our application, there is no URL to view a specific transaction. All transactions of a customer are visible in Transaction history under the static URL \\ 
\textit{"<IP>/transaction\_history"} that does not contain a parameter. Hence there is no possibility of modifying the URL, thus making our application more secure, in this aspect.
\clearpage

\subsubsection{Observation 2}
A test for this vulnerability was performed in the User page and no vulnerability has been found.

\subsubsection{Discovery}
No specific tool was used to test this vulnerability and manual testing was carried out.\\
Steps: \\
1. Login as a Customer. \\
2. Click on the Customer name next to the Logout button. \\
3. The profile and account details of the logged in customer are shown. \\
4. The URL in the address bar is of the form \\ \textit{"<IP-address>/secure-coding/public/view\_user.php?id=7"}. \\
5. Edit the id at the end to any other number, expecting to view details of a customer with that id. \\

However, the page always displays the details of the logged-in user. 
Even if the id parameter is removed from the URL, the details of the logged-in user are still visible.

\subsubsection{Likelihood}
Likelihood is high.
The attacker need not have any specialized skills to exploit this vulnerability. Any customer who is logged in to the bank can perform this action. 

\subsubsection{Impact}
If this vulnerabilty exists, then a customer can get hold of details pertaining to other customers such as Account number, current balance etc. Using the Account numbers, he/she can make infinite transactions with negative amounts, thus transferring money from the victim's account to his/her own. Knowing the current balance might further aid in performing transactions of calculated amounts, without acquiring the attention of the victim. 

\subsubsection{CVSS}
\begin{tabular}{l | l}
Attack Vector		& Network \\
Attack Complexity	& Low \\
Privileges Required & Low \\
User Interaction	& None \\
Scope				& Unchanged \\
Confidentiality		& High \\
Integrity			& None \\
Availability		& None
\end{tabular}

\subsubsection{Comparison with our application}
In our application, there is no URL to view a specific user. The user details are visible in Profile and Overview under the static URLs \\ 
\textit{"<IP>/profile"} and \textit{"<IP>/overview"} that do not contain a parameter. Hence there is no possibility of modifying the URL, thus making our application more secure, in this aspect.
\clearpage