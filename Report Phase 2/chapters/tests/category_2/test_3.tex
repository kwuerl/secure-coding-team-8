\subsection{Test Account Provisioning Process - OTG-IDENT-003} \label{OTG-IDENT-003}

\subsubsection{Observation}
A customer can approve or reject pending registrations from other customers and employees. This operation is authorized to be performed only by employees, but it has been exposed to all logged-in users. 

\subsubsection{Discovery}
This vulnerability has been exposed using the Burp Suite where the Request was monitored and intercepted to expose the vulnerability.\\
Steps: \\
1. Login as a Customer. \\
2. Enter the URL -  \textit{"<IP-address>/secure-coding/public/view\_users.php"}. \\
3. The details of all registered users are shown. \\
4. Note the ID (value in the first column - \#) of one of the users whose registration is pending. This can be identified by any rows that do not have values in "Account ID" and "Approved By" columns.\\
Consider this value is xyz. \\
5. Configure the browser to use BURP Suite as the proxy. \\
6. Open Burp Suite and navigate to the Proxy tab. \\
7. In the Intercept tab, click on "intercept is off" to turn it on.
8. In the browser, enter the URL \\
\textit{"<IP-address>/secure-coding/public/view\_user.php?id=xyz"}. \\
9. Go back to Burp and in the Options tab, check the option "intercept if" for client requests. \\
10. Move the "HTTP method" to the top by clicking on the "Up" button. Modify it to match (get|post). \\
11. Navigate back to the Intercept tab. The Request details are visible in the "raw" tab in the below format. \\ 
12. Edit the method at the beginning of the request from "GET" to "POST". \\
13. Details in the "params" tab are in the following format. \\
14. Click on "new" button and add the following parameters. \\
\begin{tabular}{l | l}
Type		& body \\
Name		& userid \\
Value 		& xyz
\end{tabular}
\begin{tabular}{l | l}
Type		& body \\
Name		& accept \\
Value 		& 
\end{tabular}

\subsubsection{Likelihood}
Likelihood is low.
The attacker does need to have knowledge about proxy or interception tools such as Burp to exploit this vulnerability. However, any user who is logged in to the bank can perform this action, without the need for any other privileges.

\subsubsection{Impact}
A customer can approve or reject registration requests from all other customers and employees. Since rejection also removes the user from the database, there will be no trace of such a registration in the system. So it will be difficult for the actual employees or administrators to track down such actions.

\subsubsection{CVSS}
\begin{tabular}{l | l}
Attack Vector		& Network \\
Attack Complexity	& High \\
Privileges Required & Low \\
User Interaction	& None \\
Scope				& Changed \\
Confidentiality		& Low \\
Integrity			& High \\
Availability		& None
\end{tabular}

\subsubsection{Comparison with our application}
In our application, the list of all users is not available for customers and is accessible only by authorized employees. Hence, it is difficult to get the details of unregistered users. In addition, approval and rejection of users is restricted to be performed by authorized employees only. So, even if the attacker manages to send a request for approval/rejection, it will not be successful. Thus our application is more secure, in this aspect.
\clearpage